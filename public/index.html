<!DOCTYPE html>
<html>

<head>
    <title>CollaboWriter</title>
<!--
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Cutive' rel='stylesheet' type='text/css'>
-->
    <link href='http://fonts.googleapis.com/css?family=Special+Elite' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <textarea id="pad" autofocus="">Connecting...</textarea>
    <script src="js/sharejs/text.js"></script>
    <script src="js/sharejs/share.uncompressed.js"></script>
    <script>
        var pad = document.getElementById('pad');

        var socket = new WebSocket('ws://' + window.location.host);
        
        var sharejs = new window.sharejs.Connection(socket);

        var collection = 'masterpieces';
        var docName = 'final draft';
        var doc = sharejs.get(collection, docName);
        console.log(doc);
        doc.subscribe();

        doc.whenReady(function () {
            if (!doc.type) doc.create('text');
            if (doc.type && doc.type.name === 'text')
                doc.attachTextarea(pad);
        });
        
        setInterval(function () {
            doc.getOps({"from": doc.version - 1, "to": doc.version});
        }, 2000);
    </script>
</body>

</html>
