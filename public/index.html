<!DOCTYPE html>
<html>

<head>
    <title>Collab</title>
    <style>
        #pad {
            width: 40em;
            height: 6em;
        }
    </style>
</head>

<body>
    <textarea id="pad" autofocus="">Connecting...</textarea>
    <script src="js/text.js"></script>
    <script src="js/share.uncompressed.js"></script>
    <script>
        var pad = document.getElementById('pad');

        var ws = new WebSocket('ws://' + window.location.host);
        
        ws.onmessage = function (event) {
            console.log(JSON.parse(event.data));
        };

        var sjs = new window.sharejs.Connection(ws);

        var doc = sjs.get('users', 'seph');
        console.log(doc);
        doc.subscribe();

        doc.whenReady(function () {
            if (!doc.type) doc.create('text');
            if (doc.type && doc.type.name === 'text')
                doc.attachTextarea(pad);
        });
    </script>
</body>

</html>
